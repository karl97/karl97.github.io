<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebGPU Example</title>
    <style>
        body, html {
            margin: 0;
            height: 100%;
            overflow: hidden;
        }
        canvas {
            width: 100%;
            height: 100%;
            display: block;
        }
    </style>
</head>
<body>
    <canvas id="gpuCanvas"></canvas>
    <script type="module">
        async function initWebGPU() {
            // Check if WebGPU is supported
            if (!navigator.gpu) {
                console.error('WebGPU is not supported by this browser.');
                return;
            }

            // Get a GPU device
            const adapter = await navigator.gpu.requestAdapter();
            const device = await adapter.requestDevice();

            // Get the canvas and configure it with WebGPU
            const canvas = document.getElementById('gpuCanvas');
            const context = canvas.getContext('webgpu');
            const canvasFormat = navigator.gpu.getPreferredCanvasFormat();

            context.configure({
                device: device,
                format: canvasFormat,
                alphaMode: 'opaque'
            });

            // Create a basic render pass
            const renderPassDescriptor = {
                colorAttachments: [
                    {
                        view: context.getCurrentTexture().createView(),
                        loadOp: 'clear',
                        clearValue: {r: 0.0, g: 0.0, b: 0.0, a: 1.0},
                        storeOp: 'store'
                    }
                ]
            };

            // Create a command encoder and render pass encoder
            const commandEncoder = device.createCommandEncoder();
            const passEncoder = commandEncoder.beginRenderPass(renderPassDescriptor);
            passEncoder.endPass();

            // Submit the commands to the GPU
            const commandBuffer = commandEncoder.finish();
            device.queue.submit([commandBuffer]);

            // Simple animation loop to keep rendering
            function frame() {
                renderPassDescriptor.colorAttachments[0].view = context.getCurrentTexture().createView();
                const commandEncoder = device.createCommandEncoder();
                const passEncoder = commandEncoder.beginRenderPass(renderPassDescriptor);
                passEncoder.endPass();
                const commandBuffer = commandEncoder.finish();
                device.queue.submit([commandBuffer]);

                requestAnimationFrame(frame);
            }
            requestAnimationFrame(frame);
        }

        // Initialize WebGPU when the page loads
        window.addEventListener('load', initWebGPU);
    </script>
</body>
</html>
